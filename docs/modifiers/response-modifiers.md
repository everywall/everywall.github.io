---
sidebar_position: 2
description: "Response modifier functions"
---

# Response modifiers

| Function                                                                | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| ----------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `APIContent()`                                                          | APIContent creates an JSON representation of the article and returns it as an API response.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| `BlockElementRemoval(cssSelector string)`                               | BlockElementRemoval prevents paywall javascript from removing a particular element by detecting the removal, then immediately reinserting it. This is useful when a page will return a "fake" 404, after flashing the content briefly. If the /outline/ API works, but the regular API doesn't, try this modifier.                                                                                                                                                                                                                                                                                       |
| `BlockThirdPartyScripts()`                                              | BlockThirdPartyScripts rewrites HTML and injects JS to block all third party JS from loading.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| `BypassCORS()`                                                          | BypassCORS modifies response headers to prevent the browser from enforcing any CORS restrictions. This should run at the end of the chain.                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| `BypassContentSecurityPolicy()`                                         | BypassContentSecurityPolicy modifies response headers to prevent the browser from enforcing any CSP restrictions. This should run at the end of the chain.                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| `DeleteIncomingCookies(_ ...string)`                                    | DeleteIncomingCookies prevents ALL cookies from being sent from the proxy server back down to the client.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| `DeleteIncomingCookiesExcept(whitelist ...string)`                      | DeleteIncomingCookiesExcept prevents non-whitelisted cookies from being sent from the proxy server to the client. Cookies whose names are in the whitelist are not removed.                                                                                                                                                                                                                                                                                                                                                                                                                              |
| `DeleteLocalStorageData()`                                              | DeleteLocalStorageData deletes localstorage cookies. If the page works once in a fresh incognito window, but fails for subsequent loads, try this response modifier alongside DeleteSessionStorageData and DeleteIncomingCookies                                                                                                                                                                                                                                                                                                                                                                         |
| `DeleteResponseHeader(key string)`                                      | DeleteResponseHeader removes response headers from the upstream server                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `DeleteSessionStorageData()`                                            | DeleteSessionStorageData deletes localstorage cookies. If the page works once in a fresh incognito window, but fails for subsequent loads, try this response modifier alongside DeleteLocalStorageData and DeleteIncomingCookies                                                                                                                                                                                                                                                                                                                                                                         |
| `ForwardResponseHeaders()`                                              | ForwardResponseHeaders forwards the response headers from the upstream server to the client                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| `GenerateReadableOutline()`                                             | GenerateReadableOutline creates an reader-friendly distilled representation of the article. This is a reliable way of bypassing soft-paywalled articles, where the content is hidden, but still present in the DOM.                                                                                                                                                                                                                                                                                                                                                                                      |
| `InjectScriptAfterDOMContentLoaded(js string)`                          | InjectScriptAfterDOMContentLoaded modifies HTTP responses to inject a JS after DOM Content is loaded (script tag in head)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| `InjectScriptAfterDOMIdle(js string)`                                   | InjectScriptAfterDOMIdle modifies HTTP responses to inject a JS after the DOM is idle (ie: js framework loaded)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| `InjectScriptBeforeDOMContentLoaded(js string)`                         | InjectScriptBeforeDOMContentLoaded modifies HTTP responses to inject a JS before DOM Content is loaded (script tag in head)                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| `ModifyIncomingScriptsWithRegex(matchRegex string, replacement string)` | ModifyIncomingScriptsWithRegex modifies all incoming javascript (application/javascript and inline `<script>` in text/html) using a regex match and replacement.                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| `PatchDynamicResourceURLs()`                                            | PatchDynamicResourceURLs patches the javascript runtime to rewrite URLs client-side. This function is designed to allow the proxified page to still be browsible by routing all resource URLs through the proxy. Native APIs capable of network requests will be hooked and the URLs arguments modified to point to the proxy instead. `fetch('/relative_path')` -> `fetch('/https://proxiedsite.com/relative_path')`. `Element.setAttribute('src', "/assets/img.jpg")` -> `Element.setAttribute('src', "/https://proxiedsite.com/assets/img.jpg")` -> `fetch('/https://proxiedsite.com/relative_path')` |
| `PatchTrackerScripts()`                                                 | PatchTrackerScripts replaces any request to tracker scripts such as google analytics with a no-op stub that mocks the API structure of the original scripts they replace. Some pages depend on the existence of these structures for proper loading, so this may fix some broken elements. Surrogate script code borrowed from: DuckDuckGo Privacy Essentials browser extension for Firefox, Chrome. (Apache 2.0 license)                                                                                                                                                                                |
| `RewriteHTMLResourceURLs()`                                             | RewriteHTMLResourceURLs modifies HTTP responses to rewrite URLs attributes in HTML content (such as src, href) - `<img src='/relative_path'>`->`<img                                                                                                                                                           src='/https://proxiedsite.com/relative_path'>`. This function is designed to allow the proxified page to still be browsible by routing all resource URLs through the proxy.                                                                                                               |
| `SetContentSecurityPolicy(csp string)`                                  | SetContentSecurityPolicy modifies response headers to a specific CSP                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| `SetIncomingCookie(name string, val string)`                            | SetIncomingCookie modifies a specific cookie in the response from the proxy server to the client.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| `SetIncomingCookies(cookies string)`                                    | SetIncomingCookies adds a raw cookie string being sent from the proxy server down to the client                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| `SetResponseHeader(key string, value string)`                           | SetResponseHeader modifies response headers from the upstream server                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
